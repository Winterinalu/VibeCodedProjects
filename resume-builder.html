<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Resume Builder</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;700&family=Roboto+Mono&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --page-width: 210mm;
            --page-height: 297mm;
            --transition-speed: 0.3s;
        }

        body {
            font-family: 'Inter', sans-serif;
            height: 100vh;
            overflow: hidden;
            transition: background-color var(--transition-speed), color var(--transition-speed);
        }

        /* Independent Scroll Containers */
        #editor-panel {
            height: calc(100vh - 64px);
            overflow-y: auto;
            transition: background-color var(--transition-speed), border-color var(--transition-speed);
        }

        #preview-area {
            height: calc(100vh - 64px);
            overflow-y: auto;
            display: flex;
            justify-content: center;
            padding: 40px 20px;
            transition: background-color var(--transition-speed);
        }

        #resume-canvas {
            width: var(--page-width);
            min-height: var(--page-height);
            background: white;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            transform-origin: top center;
            transition: transform 0.2s ease;
            position: relative;
        }

        /* --- THEME OVERLAYS --- */
        
        /* Modern / Default */
        body.theme-modern { background-color: #f8fafc; color: #1e293b; }
        body.theme-modern #editor-panel { background-color: white; border-right: 1px solid #e2e8f0; }
        body.theme-modern #preview-area { background-color: #cbd5e1; }
        body.theme-modern nav { background-color: white; border-bottom: 1px solid #e2e8f0; }

        /* Minimalist */
        body.theme-minimal { background-color: #ffffff; color: #0f172a; }
        body.theme-minimal #editor-panel { background-color: #fcfcfc; border-right: 1px solid #f1f5f9; }
        body.theme-minimal #preview-area { background-color: #e2e8f0; }
        body.theme-minimal nav { background-color: white; border-bottom: 1px solid #f1f5f9; }

        /* Cyber / Creative */
        body.theme-cyber { background-color: #05070a; color: #e5e7eb; }
        body.theme-cyber #editor-panel { background-color: #0B0F1A; border-right: 1px solid #1B2140; }
        body.theme-cyber #preview-area { background-color: #020617; }
        body.theme-cyber nav { background-color: #11162A; border-bottom: 1px solid #1B2140; color: white; }
        body.theme-cyber .standard-input { background-color: #0d1221; border-color: #1B2140; color: white; }
        body.theme-cyber .standard-input:focus { border-color: #00F5FF; }
        body.theme-cyber .section-label { color: #00F5FF; }
        body.theme-cyber h3 { color: #FF2ED1 !important; border-color: #1B2140 !important; }
        body.theme-cyber .bg-gray-50 { background-color: #0d1221; border-color: #1B2140; }
        body.theme-cyber .text-indigo-900 { color: #FF2ED1; }
        body.theme-cyber .text-indigo-600 { color: #00F5FF; }
        body.theme-cyber .bg-white { background-color: #11162A; border-color: #1B2140; }
        body.theme-cyber #zoom-controls { background-color: #11162A !important; border-color: #1B2140 !important; color: #00F5FF !important; }
        body.theme-cyber button[onclick^="addItem"], body.theme-cyber button[onclick^="removeItem"] { color: #00F5FF; }
        body.theme-cyber button[onclick^="removeItem"] { color: #ff3b3b; }

        /* Standard Input Styles */
        .standard-input {
            width: 100%;
            padding: 0.625rem;
            background-color: #ffffff;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            transition: all 0.2s;
        }
        .standard-input:focus {
            outline: none;
            border-color: #4f46e5;
            box-shadow: 0 0 0 2px rgba(79, 70, 229, 0.1);
        }

        .section-label {
            display: block;
            font-size: 0.75rem;
            font-weight: 600;
            color: #475569;
            text-transform: uppercase;
            letter-spacing: 0.025em;
            margin-bottom: 0.25rem;
        }

        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        
        body.theme-cyber .custom-scrollbar::-webkit-scrollbar-thumb { background: #1B2140; }

        @media print {
            #editor-panel, nav, #zoom-controls { display: none !important; }
            #preview-area { padding: 0 !important; background: white !important; height: auto; overflow: visible; }
            #resume-canvas { transform: scale(1) !important; margin: 0 !important; box-shadow: none; }
        }
    </style>
</head>
<body class="theme-modern">

    <!-- Navigation Bar -->
    <nav class="h-16 flex items-center justify-between px-6 sticky top-0 z-50 transition-colors">
        <div class="flex items-center gap-3">
            <div id="nav-icon-bg" class="bg-indigo-600 text-white p-2 rounded-lg shadow-sm">
                <i class="fas fa-file-alt fa-lg"></i>
            </div>
            <div>
                <h1 id="nav-title" class="text-lg font-bold leading-tight">ResumePro</h1>
                <p id="nav-subtitle" class="text-[10px] text-gray-500 font-medium">Build your career</p>
            </div>
        </div>



        <div class="flex items-center gap-4">
            
            <button class="bg-indigo-600 hover:bg-indigo-700 text-white px-5 py-2 rounded-lg text-sm font-bold flex items-center gap-2 transition-all shadow-md active:scale-95" onclick="location.href='index.html'">
                Return to main menu.
            </button>

            <div class="flex items-center gap-2">
                <span class="text-xs font-semibold text-gray-400 uppercase">Theme:</span>
                <select id="template-selector" class="bg-gray-50 border border-gray-300 text-xs rounded-lg focus:ring-indigo-500 focus:border-indigo-500 block p-2 outline-none transition-colors">
                    <option value="modern">Professional (Modern)</option>
                    <option value="minimal">Minimalist (Classic)</option>
                    <option value="cyber">Creative (Dark Mode)</option>
                </select>
            </div>
            
            <div class="h-6 w-px bg-gray-200 mx-2 opacity-20"></div>
            
            <button onclick="downloadPDF()" id="download-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white px-5 py-2 rounded-lg text-sm font-bold flex items-center gap-2 transition-all shadow-md active:scale-95">
                <i class="fas fa-download"></i> Download PDF
            </button>
        </div>
    </nav>

    <main class="flex h-[calc(100vh-64px)]">
        <!-- Editor Sidebar -->
        <aside id="editor-panel" class="w-1/3 min-w-[400px] custom-scrollbar p-8 transition-colors">
            
            <!-- Personal Information -->
            <div class="mb-10">
                <h3 class="text-sm font-bold text-indigo-900 mb-6 flex items-center gap-2 border-b border-indigo-100 pb-2 transition-colors">
                    <i class="fas fa-id-card"></i> Personal Details
                </h3>
                <div class="space-y-4">
                    <div class="flex items-center gap-4 mb-6 p-4 bg-gray-50 rounded-xl border border-gray-200 transition-colors">
                        <div id="image-preview" class="w-20 h-20 rounded-full border-2 border-white shadow-sm overflow-hidden flex items-center justify-center bg-gray-200 shrink-0">
                            <i class="fas fa-user text-gray-400 text-2xl"></i>
                        </div>
                        <div class="flex-1">
                            <label class="section-label">Profile Photo</label>
                            <input type="file" id="photo-upload" accept="image/*" class="text-xs text-gray-500 file:mr-3 file:py-1.5 file:px-3 file:rounded-full file:border-0 file:text-xs file:font-bold file:bg-indigo-100 file:text-indigo-700 hover:file:bg-indigo-200 cursor-pointer transition-all">
                        </div>
                    </div>
                    
                    <div>
                        <label class="section-label">Full Name</label>
                        <input type="text" data-key="personal.name" placeholder="Enter your full name" class="standard-input field-input">
                    </div>
                    <div>
                        <label class="section-label">Professional Title</label>
                        <input type="text" data-key="personal.title" placeholder="e.g. Software Engineer" class="standard-input field-input">
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="section-label">Email</label>
                            <input type="email" data-key="personal.email" placeholder="email@address.com" class="standard-input field-input">
                        </div>
                        <div>
                            <label class="section-label">Phone</label>
                            <input type="tel" data-key="personal.phone" placeholder="+1 000 000 0000" class="standard-input field-input">
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="section-label">Location</label>
                            <input type="text" data-key="personal.location" placeholder="City, Country" class="standard-input field-input">
                        </div>
                        <div>
                            <label class="section-label">Website / Link</label>
                            <input type="text" data-key="personal.website" placeholder="portfolio.com" class="standard-input field-input">
                        </div>
                    </div>
                    <div>
                        <label class="section-label">Professional Summary</label>
                        <textarea data-key="personal.summary" placeholder="Write a brief overview of your professional background..." rows="4" class="standard-input field-input"></textarea>
                    </div>
                </div>
            </div>

            <!-- Work Experience -->
            <div class="mb-10">
                <div class="flex items-center justify-between mb-6 border-b border-indigo-100 pb-2 transition-colors">
                    <h3 class="text-sm font-bold text-indigo-900 flex items-center gap-2">
                        <i class="fas fa-briefcase"></i> Work Experience
                    </h3>
                    <button onclick="addItem('experience')" class="text-[11px] font-bold text-indigo-600 hover:text-indigo-800 transition-colors uppercase tracking-wider">+ Add Position</button>
                </div>
                <div id="experience-list" class="space-y-6"></div>
            </div>

            <!-- Education -->
            <div class="mb-10">
                <div class="flex items-center justify-between mb-6 border-b border-indigo-100 pb-2 transition-colors">
                    <h3 class="text-sm font-bold text-indigo-900 flex items-center gap-2">
                        <i class="fas fa-graduation-cap"></i> Education
                    </h3>
                    <button onclick="addItem('education')" class="text-[11px] font-bold text-indigo-600 hover:text-indigo-800 transition-colors uppercase tracking-wider">+ Add Education</button>
                </div>
                <div id="education-list" class="space-y-6"></div>
            </div>

            <!-- Skills -->
            <div class="mb-10">
                <h3 class="text-sm font-bold text-indigo-900 mb-4 flex items-center gap-2 border-b border-indigo-100 pb-2 transition-colors">
                    <i class="fas fa-tools"></i> Skills & Expertise
                </h3>
                <div>
                    <label class="section-label">Technical Skills (Comma separated)</label>
                    <textarea data-key="skills" placeholder="JavaScript, React, Project Management, SQL..." rows="3" class="standard-input field-input"></textarea>
                </div>
            </div>
        </aside>

        <!-- Preview Area -->
        <section id="preview-area" class="flex-1 relative transition-colors">
            <div id="zoom-controls" class="fixed bottom-8 right-8 z-10 flex items-center bg-white shadow-xl rounded-full px-5 py-2.5 gap-5 border border-gray-200 transition-colors">
                <button onclick="adjustZoom(-0.1)" class="text-gray-400 hover:text-indigo-600 transition-colors"><i class="fas fa-minus"></i></button>
                <span id="zoom-label" class="text-xs font-bold text-gray-700 min-w-[45px] text-center">100%</span>
                <button onclick="adjustZoom(0.1)" class="text-gray-400 hover:text-indigo-600 transition-colors"><i class="fas fa-plus"></i></button>
                <div class="w-px h-4 bg-gray-200"></div>
                <button onclick="resetZoom()" class="text-xs font-bold text-indigo-600 hover:text-indigo-800 transition-colors">AUTO-FIT</button>
            </div>

            <div id="resume-canvas"></div>
        </section>
    </main>

    <div id="toast" class="fixed bottom-10 left-1/2 -translate-x-1/2 transform bg-gray-900 text-white px-8 py-3 rounded-full shadow-2xl transition-all duration-300 opacity-0 pointer-events-none z-[100] text-sm font-medium">
        <span id="toast-message">Notification</span>
    </div>

    <script>
        let resumeData = {
            personal: {
                name: "",
                title: "",
                email: "",
                phone: "",
                location: "",
                website: "",
                summary: "",
                image: ""
            },
            experience: [],
            education: [],
            skills: "",
            theme: {
                accent: "#4f46e5",
                font: "font-sans",
                template: "modern"
            }
        };

        let currentZoom = 0.8;

        window.onload = () => {
            syncInputs();
            renderItems();
            renderPreview();
            initEventListeners();
            setTimeout(resetZoom, 300);
        };

        function initEventListeners() {
            document.querySelectorAll('.field-input').forEach(input => {
                input.addEventListener('input', (e) => {
                    const key = e.target.getAttribute('data-key');
                    updateNestedState(resumeData, key, e.target.value);
                    autoSave();
                    renderPreview();
                });
            });

            document.getElementById('photo-upload').addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        resumeData.personal.image = event.target.result;
                        document.getElementById('image-preview').innerHTML = `<img src="${event.target.result}" class="w-full h-full object-cover">`;
                        autoSave();
                        renderPreview();
                    };
                    reader.readAsDataURL(file);
                }
            });

            document.getElementById('template-selector').addEventListener('change', (e) => {
                resumeData.theme.template = e.target.value;
                autoSave();
                renderPreview();
            });

            window.addEventListener('resize', resetZoom);
        }

        function updateNestedState(obj, path, value) {
            const keys = path.split('.');
            let current = obj;
            for (let i = 0; i < keys.length - 1; i++) {
                current = current[keys[i]];
            }
            current[keys[keys.length - 1]] = value;
        }

        function syncInputs() {
            document.querySelectorAll('.field-input').forEach(input => {
                const key = input.getAttribute('data-key');
                const val = key.split('.').reduce((o, i) => o ? o[i] : '', resumeData);
                input.value = val || '';
            });
            document.getElementById('template-selector').value = resumeData.theme.template;
            if (resumeData.personal.image) {
                document.getElementById('image-preview').innerHTML = `<img src="${resumeData.personal.image}" class="w-full h-full object-cover">`;
            } else {
                document.getElementById('image-preview').innerHTML = `<i class="fas fa-user text-gray-400 text-2xl"></i>`;
            }
        }

        function addItem(type) {
            const newItem = type === 'experience' 
                ? { id: Date.now(), company: "", role: "", duration: "", desc: "" }
                : { id: Date.now(), school: "", degree: "", year: "" };
            resumeData[type].push(newItem);
            renderItems();
            autoSave();
        }

        function removeItem(type, id) {
            resumeData[type] = resumeData[type].filter(item => item.id !== id);
            renderItems();
            renderPreview();
            autoSave();
        }

        function renderItems() {
            const expList = document.getElementById('experience-list');
            expList.innerHTML = '';
            resumeData.experience.forEach((exp) => {
                const div = document.createElement('div');
                div.className = "p-5 bg-white border border-gray-200 rounded-xl space-y-3 relative group hover:border-indigo-200 transition-colors";
                div.innerHTML = `
                    <button onclick="removeItem('experience', ${exp.id})" class="absolute top-3 right-3 text-gray-300 hover:text-red-500 transition-opacity"><i class="fas fa-trash-alt text-xs"></i></button>
                    <div>
                        <label class="section-label">Company / Organization</label>
                        <input type="text" value="${exp.company}" placeholder="e.g. Acme Corp" class="standard-input" oninput="updateItem('experience', ${exp.id}, 'company', this.value)">
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="section-label">Role Title</label>
                            <input type="text" value="${exp.role}" placeholder="e.g. Project Lead" class="standard-input" oninput="updateItem('experience', ${exp.id}, 'role', this.value)">
                        </div>
                        <div>
                            <label class="section-label">Dates</label>
                            <input type="text" value="${exp.duration}" placeholder="e.g. 2020 - 2023" class="standard-input" oninput="updateItem('experience', ${exp.id}, 'duration', this.value)">
                        </div>
                    </div>
                    <div>
                        <label class="section-label">Job Responsibilities</label>
                        <textarea class="standard-input" rows="3" placeholder="Describe your achievements..." oninput="updateItem('experience', ${exp.id}, 'desc', this.value)">${exp.desc}</textarea>
                    </div>
                `;
                expList.appendChild(div);
            });

            const eduList = document.getElementById('education-list');
            eduList.innerHTML = '';
            resumeData.education.forEach((edu) => {
                const div = document.createElement('div');
                div.className = "p-5 bg-white border border-gray-200 rounded-xl space-y-3 relative group hover:border-indigo-200 transition-colors";
                div.innerHTML = `
                    <button onclick="removeItem('education', ${edu.id})" class="absolute top-3 right-3 text-gray-300 hover:text-red-500 transition-opacity"><i class="fas fa-trash-alt text-xs"></i></button>
                    <div>
                        <label class="section-label">School / University</label>
                        <input type="text" value="${edu.school}" placeholder="e.g. Yale University" class="standard-input" oninput="updateItem('education', ${edu.id}, 'school', this.value)">
                    </div>
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="section-label">Degree / Field</label>
                            <input type="text" value="${edu.degree}" placeholder="e.g. MBA" class="standard-input" oninput="updateItem('education', ${edu.id}, 'degree', this.value)">
                        </div>
                        <div>
                            <label class="section-label">Years</label>
                            <input type="text" value="${edu.year}" placeholder="e.g. 2012 - 2016" class="standard-input" oninput="updateItem('education', ${edu.id}, 'year', this.value)">
                        </div>
                    </div>
                `;
                eduList.appendChild(div);
            });
        }

        function updateItem(type, id, field, value) {
            const item = resumeData[type].find(i => i.id === id);
            if (item) {
                item[field] = value;
                autoSave();
                renderPreview();
            }
        }

        function autoSave() {
            localStorage.setItem('professional_resume_data', JSON.stringify(resumeData));
        }

        function renderPreview() {
            const canvas = document.getElementById('resume-canvas');
            const template = resumeData.theme.template;
            
            // Sync Global App UI
            document.body.className = `theme-${template}`;
            
            if (template === 'cyber') {
                canvas.style.backgroundColor = '#0B0F1A';
                canvas.innerHTML = renderCyberTemplate();
            } else if (template === 'modern') {
                canvas.style.backgroundColor = 'white';
                canvas.innerHTML = renderModernTemplate();
            } else {
                canvas.style.backgroundColor = 'white';
                canvas.innerHTML = renderMinimalistTemplate();
            }
        }

        function renderCyberTemplate() {
            const photoHtml = resumeData.personal.image ? `<div class="w-24 h-24 border-2 border-[#00F5FF] mb-6 shadow-[0_0_15px_rgba(0,245,255,0.4)] overflow-hidden"><img src="${resumeData.personal.image}" class="w-full h-full object-cover grayscale brightness-125"></div>` : '';
            return `
                <div class="p-16 h-full text-slate-200 font-sans tracking-tight">
                    <header class="mb-12 border-l-4 border-[#00F5FF] pl-8">
                        ${photoHtml}
                        <h1 class="text-5xl font-black text-[#00F5FF] uppercase tracking-tighter mb-1 font-['Orbitron']">${resumeData.personal.name || ''}</h1>
                        <p class="text-xl font-bold text-[#FF2ED1] opacity-90 uppercase tracking-widest font-['Orbitron']">${resumeData.personal.title || ''}</p>
                        <div class="flex gap-4 mt-4 text-[10px] text-slate-500 font-mono">
                            ${resumeData.personal.email ? `<span>// ${resumeData.personal.email}</span>` : ''}
                            ${resumeData.personal.location ? `<span>// ${resumeData.personal.location}</span>` : ''}
                            ${resumeData.personal.phone ? `<span>// ${resumeData.personal.phone}</span>` : ''}
                        </div>
                    </header>
                    <div class="grid grid-cols-3 gap-12">
                        <div class="col-span-2 space-y-12">
                            ${resumeData.experience.length ? `
                            <section>
                                <h2 class="text-xs font-bold text-[#00F5FF] mb-6 border-b border-slate-800 pb-2 uppercase tracking-widest font-['Orbitron']">Sector History</h2>
                                <div class="space-y-8">
                                    ${resumeData.experience.map(exp => `
                                        <div>
                                            <div class="flex justify-between items-baseline mb-2">
                                                <h3 class="text-lg font-bold text-white uppercase tracking-wider">${exp.company}</h3>
                                                <span class="text-[10px] text-[#FF2ED1] font-mono">${exp.duration}</span>
                                            </div>
                                            <p class="text-sm font-bold text-slate-400 mb-2">${exp.role}</p>
                                            <p class="text-xs text-slate-500 whitespace-pre-line leading-relaxed">${exp.desc}</p>
                                        </div>
                                    `).join('')}
                                </div>
                            </section>` : ''}
                        </div>
                        <div class="space-y-12">
                            ${resumeData.skills ? `
                            <section>
                                <h2 class="text-xs font-bold text-[#00FF9C] mb-6 border-b border-slate-800 pb-2 uppercase tracking-widest font-['Orbitron']">Tech Stack</h2>
                                <div class="flex flex-wrap gap-2">
                                    ${resumeData.skills.split(',').map(s => s.trim()).filter(s => s).map(s => `
                                        <span class="px-2 py-1 bg-slate-800 border border-[#00FF9C] text-[#00FF9C] text-[9px] font-mono">${s}</span>
                                    `).join('')}
                                </div>
                            </section>` : ''}
                            ${resumeData.education.length ? `
                            <section>
                                <h2 class="text-xs font-bold text-[#7C3AED] mb-6 border-b border-slate-800 pb-2 uppercase tracking-widest font-['Orbitron']">Uplink Protocols</h2>
                                ${resumeData.education.map(edu => `
                                    <div class="mb-4">
                                        <p class="text-xs font-bold text-white">${edu.school}</p>
                                        <p class="text-[10px] text-[#7C3AED]">${edu.degree}</p>
                                        <p class="text-[9px] text-gray-500 font-mono">${edu.year}</p>
                                    </div>
                                `).join('')}
                            </section>` : ''}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderModernTemplate() {
            const photoHtml = resumeData.personal.image ? `<div class="w-28 h-28 rounded-2xl border-4 border-white shadow-lg overflow-hidden shrink-0"><img src="${resumeData.personal.image}" class="w-full h-full object-cover"></div>` : '';
            return `
                <div class="p-16 text-slate-800 font-sans leading-relaxed">
                    <header class="flex items-center gap-10 mb-12 pb-10 border-b border-slate-100">
                        ${photoHtml}
                        <div class="flex-1">
                            <h1 class="text-4xl font-extrabold text-slate-900 tracking-tight">${resumeData.personal.name || ''}</h1>
                            <p class="text-xl text-indigo-600 font-bold mt-1">${resumeData.personal.title || ''}</p>
                            <div class="mt-6 flex flex-wrap gap-x-6 gap-y-2 text-xs text-slate-500 font-semibold">
                                ${resumeData.personal.email ? `<span class="flex items-center gap-2"><i class="fas fa-envelope text-indigo-400"></i> ${resumeData.personal.email}</span>` : ''}
                                ${resumeData.personal.phone ? `<span class="flex items-center gap-2"><i class="fas fa-phone text-indigo-400"></i> ${resumeData.personal.phone}</span>` : ''}
                                ${resumeData.personal.location ? `<span class="flex items-center gap-2"><i class="fas fa-map-marker-alt text-indigo-400"></i> ${resumeData.personal.location}</span>` : ''}
                            </div>
                        </div>
                    </header>
                    <div class="grid grid-cols-3 gap-12">
                        <div class="col-span-2 space-y-10">
                            ${resumeData.personal.summary ? `
                            <section>
                                <h2 class="text-xs font-bold uppercase tracking-[0.2em] text-indigo-600 mb-5 flex items-center gap-3">
                                    Professional Summary <span class="flex-1 h-px bg-indigo-50"></span>
                                </h2>
                                <p class="text-[14px] text-slate-600 leading-relaxed">${resumeData.personal.summary}</p>
                            </section>` : ''}
                            ${resumeData.experience.length ? `
                            <section>
                                <h2 class="text-xs font-bold uppercase tracking-[0.2em] text-indigo-600 mb-8 flex items-center gap-3">
                                    Experience <span class="flex-1 h-px bg-indigo-50"></span>
                                </h2>
                                <div class="space-y-10">
                                    ${resumeData.experience.map(exp => `
                                        <div class="relative">
                                            <div class="flex justify-between items-start mb-2">
                                                <h3 class="text-base font-bold text-slate-900">${exp.company}</h3>
                                                <span class="text-[11px] font-bold text-slate-400 uppercase tracking-wider">${exp.duration}</span>
                                            </div>
                                            <p class="text-[14px] font-semibold text-indigo-500 mb-3">${exp.role}</p>
                                            <p class="text-[13px] text-slate-600 whitespace-pre-line leading-relaxed">${exp.desc}</p>
                                        </div>
                                    `).join('')}
                                </div>
                            </section>` : ''}
                        </div>
                        <div class="space-y-10">
                            ${resumeData.skills ? `
                            <section>
                                <h2 class="text-xs font-bold uppercase tracking-[0.2em] text-indigo-600 mb-6">Expertise</h2>
                                <div class="flex flex-wrap gap-2">
                                    ${resumeData.skills.split(',').map(s => s.trim()).filter(s => s).map(s => `
                                        <span class="px-3 py-1.5 bg-slate-50 text-slate-700 text-[11px] font-bold rounded-lg border border-slate-100">${s}</span>
                                    `).join('')}
                                </div>
                            </section>` : ''}
                            ${resumeData.education.length ? `
                            <section>
                                <h2 class="text-xs font-bold uppercase tracking-[0.2em] text-indigo-600 mb-6">Education</h2>
                                <div class="space-y-5">
                                    ${resumeData.education.map(edu => `
                                        <div>
                                            <h3 class="text-[13px] font-bold text-slate-800">${edu.school}</h3>
                                            <p class="text-xs text-indigo-500 font-semibold">${edu.degree}</p>
                                            <p class="text-[10px] text-slate-400 font-bold mt-1">${edu.year}</p>
                                        </div>
                                    `).join('')}
                                </div>
                            </section>` : ''}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderMinimalistTemplate() {
            const photoHtml = resumeData.personal.image ? `<div class="w-24 h-24 mb-8 mx-auto overflow-hidden rounded-full border border-gray-100"><img src="${resumeData.personal.image}" class="w-full h-full object-cover grayscale"></div>` : '';
            return `
                <div class="p-20 text-slate-900 font-serif">
                    <header class="text-center mb-16">
                        ${photoHtml}
                        <h1 class="text-5xl font-normal tracking-tight mb-4">${resumeData.personal.name || ''}</h1>
                        <p class="text-sm uppercase tracking-[0.4em] text-slate-400 mb-8 font-sans">${resumeData.personal.title || ''}</p>
                        <div class="flex justify-center gap-6 text-[11px] uppercase font-sans tracking-widest text-slate-400 border-t border-b border-gray-50 py-4 max-w-lg mx-auto">
                             ${resumeData.personal.email ? `<span>${resumeData.personal.email}</span>` : ''}
                             ${resumeData.personal.location ? `<span>&bull;</span><span>${resumeData.personal.location}</span>` : ''}
                             ${resumeData.personal.phone ? `<span>&bull;</span><span>${resumeData.personal.phone}</span>` : ''}
                        </div>
                    </header>
                    <div class="max-w-2xl mx-auto space-y-16">
                        ${resumeData.personal.summary ? `<p class="text-center text-slate-600 leading-loose text-[15px] italic font-normal">"${resumeData.personal.summary}"</p>` : ''}
                        ${resumeData.experience.length ? `
                        <section>
                            <h2 class="text-center text-[10px] font-bold uppercase tracking-[0.3em] text-slate-300 mb-10 font-sans">Professional Path</h2>
                            <div class="space-y-12">
                                ${resumeData.experience.map(exp => `
                                    <div class="text-center">
                                        <p class="font-bold text-lg text-slate-900 mb-1">${exp.company}</p>
                                        <p class="text-xs text-slate-400 uppercase tracking-widest mb-4 font-sans">${exp.role} / ${exp.duration}</p>
                                        <p class="text-[15px] text-slate-700 leading-relaxed font-normal">${exp.desc}</p>
                                    </div>
                                `).join('')}
                            </div>
                        </section>` : ''}
                    </div>
                </div>
            `;
        }

        function adjustZoom(delta) {
            currentZoom = Math.min(Math.max(0.3, currentZoom + delta), 2);
            applyZoom();
        }

        function resetZoom() {
            const containerWidth = document.getElementById('preview-area').offsetWidth - 100;
            const pageWidth = 794; 
            currentZoom = containerWidth / pageWidth;
            applyZoom();
        }

        function applyZoom() {
            const canvas = document.getElementById('resume-canvas');
            canvas.style.transform = `scale(${currentZoom})`;
            document.getElementById('zoom-label').innerText = `${Math.round(currentZoom * 100)}%`;
        }

        async function downloadPDF() {
            const element = document.getElementById('resume-canvas');
            const prevTransform = element.style.transform;
            element.style.transform = 'scale(1)';
            
            const opt = {
                margin: 0,
                filename: `Resume_${resumeData.personal.name.replace(/\s+/g, '_') || 'Builder'}.pdf`,
                image: { type: 'jpeg', quality: 1 },
                html2canvas: { scale: 2, useCORS: true, backgroundColor: resumeData.theme.template === 'cyber' ? '#0B0F1A' : '#ffffff' },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };

            showToast("Generating your resume PDF...");
            try {
                await html2pdf().set(opt).from(element).save();
                showToast("PDF successfully downloaded.");
            } catch (err) {
                showToast("Export failed. Please try again.");
            } finally {
                element.style.transform = prevTransform;
            }
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            document.getElementById('toast-message').innerText = message;
            toast.classList.remove('opacity-0', 'pointer-events-none');
            toast.classList.add('translate-y-[-10px]');
            setTimeout(() => {
                toast.classList.add('opacity-0', 'pointer-events-none');
                toast.classList.remove('translate-y-[-10px]');
            }, 3000);
        }
    </script>
</body>
</html>